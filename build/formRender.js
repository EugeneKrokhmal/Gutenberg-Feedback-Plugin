(()=>{"use strict";var e={338:(e,a,t)=>{var r=t(795);a.H=r.createRoot,r.hydrateRoot},795:e=>{e.exports=window.ReactDOM}},a={};const t=window.wp.i18n,r=window.wp.element;var l=function t(r){var l=a[r];if(void 0!==l)return l.exports;var i=a[r]={exports:{}};return e[r](i,i.exports,t),i.exports}(338);const i=({attributes:e})=>{const[a,l]=(0,r.useState)({firstName:"",lastName:"",email:"",subject:"",message:""});return(0,r.useEffect)((()=>{fetch("/wp-json/wp/v2/users/me",{credentials:"include"}).then((e=>{if(!e.ok)throw new Error((0,t.__)("Not logged in","feedback-plugin"));return e.json()})).then((e=>{l({firstName:e.first_name||"",lastName:e.last_name||"",email:e.email||"",subject:"",message:""})})).catch((()=>{}))}),[]),React.createElement("form",{className:"feedback-form"},React.createElement("h2",{id:"feedback-form-title"},(0,t.__)("Feedback Form","feedback-plugin")),React.createElement("div",null,React.createElement("label",{htmlFor:"firstName"},e.labelFirstName,e.isFirstNameRequired&&React.createElement("span",{className:"required"},"*")),React.createElement("input",{type:"text",id:"firstName",name:"firstName",required:e.isFirstNameRequired,"aria-required":e.isFirstNameRequired?"true":"false","aria-labelledby":"firstName-label",value:a.firstName,onChange:e=>l({...a,firstName:e.target.value})})),React.createElement("div",null,React.createElement("label",{htmlFor:"lastName"},e.labelLastName),React.createElement("input",{type:"text",id:"lastName",name:"lastName",value:a.lastName,"aria-labelledby":"lastName",onChange:e=>l({...a,lastName:e.target.value})})),React.createElement("div",null,React.createElement("label",{htmlFor:"email"},e.labelEmail,e.isEmailRequired&&React.createElement("span",{className:"required"},"*")),React.createElement("input",{type:"email",id:"email",name:"email",required:e.isEmailRequired,value:a.email,"aria-required":e.isEmailRequired?"true":"false","aria-labelledby":"email",onChange:e=>l({...a,email:e.target.value})})),React.createElement("div",null,React.createElement("label",{htmlFor:"subject"},e.labelSubject,e.isSubjectRequired&&React.createElement("span",{className:"required"},"*")),React.createElement("input",{type:"text",id:"subject",name:"subject",required:e.isSubjectRequired,"aria-required":e.isSubjectRequired?"true":"false","aria-labelledby":"subject",value:a.subject,onChange:e=>l({...a,subject:e.target.value})})),React.createElement("div",null,React.createElement("label",{htmlFor:"message"},e.labelMessage,e.isMessageRequired&&React.createElement("span",{className:"required"},"*")),React.createElement("textarea",{id:"message",name:"message",rows:"5",required:e.isMessageRequired,"aria-required":e.isMessageRequired?"true":"false","aria-labelledby":"message",value:a.message,onChange:e=>l({...a,message:e.target.value})})),React.createElement("button",{className:"wp-block-button__link wp-element-button",type:"submit","aria-label":(0,t.__)("Submit Feedback","feedback-plugin")},(0,t.__)("Submit","feedback-plugin")))},s={labelFirstName:(0,t.__)("First Name","feedback-plugin"),labelLastName:(0,t.__)("Last Name","feedback-plugin"),labelEmail:(0,t.__)("Email","feedback-plugin"),labelMessage:(0,t.__)("Message","feedback-plugin"),isFirstNameRequired:!0,isLastNameRequired:!0,isEmailRequired:!0,isSubjectRequired:!0,isMessageRequired:!0},n=async e=>{const a=e.target.closest("form.feedback-form");if(!(a&&a instanceof HTMLFormElement))return;e.preventDefault();const r=a.querySelector("button[type='submit']");c(r,!0,(0,t.__)("Submitting...","feedback-plugin"));try{const e=new FormData(a);e.append("action","submit_feedback"),e.append("_wpnonce",feedbackAjax?.nonce);const r=await fetch(feedbackAjax?.ajaxUrl,{method:"POST",body:e});if(!r.ok)throw new Error((0,t.__)("HTTP error! Status:","feedback-plugin")+` ${r.status}`);const l=await r.json();l.success?a.innerHTML=`<p role="alert">${(0,t.__)("Thank you for your feedback!","feedback-plugin")}</p>`:u(l.message||(0,t.__)("Error submitting feedback.","feedback-plugin"))}catch(e){console.error((0,t.__)("Error submitting feedback:","feedback-plugin"),e),u((0,t.__)("There was an issue submitting your feedback. Please try again later.","feedback-plugin"))}finally{c(r,!1,(0,t.__)("Submit","feedback-plugin"))}},c=(e,a,t)=>{e&&(e.disabled=a,e.textContent=t)},u=e=>{alert(e)};document.addEventListener("DOMContentLoaded",(()=>{document.querySelectorAll(".feedback-form-container").forEach((e=>{try{const a=e.dataset.attributes?JSON.parse(e.dataset.attributes):s;(0,l.H)(e).render((0,r.createElement)(i,{attributes:a}))}catch(e){console.error((0,t.__)("Error parsing attributes:","feedback-plugin"),e)}})),document.body.addEventListener("submit",n)}))})();